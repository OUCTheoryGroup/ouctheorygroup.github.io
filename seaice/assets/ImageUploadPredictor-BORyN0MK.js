import{av as ve,I as me,o as Fe,aw as Je,N as De,a1 as re,ab as Ze,M as ae,y as G,t as B,ax as he,z as se,ay as Qe,az as xe,aA as et,aB as tt,aC as N,l as J,m as L,v as j,b as S,aD as le,F as R,aE as st,aF as ot,ah as Re,J as ie,aG as at,d as g,c as T,a as I,G as k,f as e,Y as X,w as P,e as z,V as Be,al as Y,Z as _,W as K,H as ee,aH as nt,q as lt,aI as rt,T as be,r as q,aJ as it,aK as ut,aL as ct,R as dt,aM as ft,aN as ke,S as pt,a7 as vt,B as Ie,aO as mt,a9 as yt,aP as gt,aQ as ue,ao as ce,aR as ht,aS as bt,a2 as ye,aT as kt,aU as Ue,aV as wt,aW as ge,aX as Me,p as we,n as Oe,ag as Ae,aY as de,a6 as ne,Q as Ct,aZ as $t,ai as Ne,ac as te,a_ as Et,a$ as qe,b0 as ze,$ as Lt,b1 as fe,b2 as Ce,b3 as Pt,b4 as St,A as _t,b5 as Tt,aq as Ft,X as $e,an as Dt,L as Rt,_ as Bt,at as It}from"./index-BzxH5ATb.js";import{b as Ut,U as je,i as Mt,c as Q}from"./el-scrollbar-Clonkl5g.js";var Ot=1,At=4;function Ee(t){return Ut(t,Ot|At)}let oe;const Nt=t=>{var o;if(!ve)return 0;if(oe!==void 0)return oe;const s=document.createElement("div");s.className=`${t}-scrollbar__wrap`,s.style.visibility="hidden",s.style.width="100px",s.style.position="absolute",s.style.top="-9999px",document.body.appendChild(s);const r=s.offsetWidth;s.style.overflow="scroll";const l=document.createElement("div");l.style.width="100%",s.appendChild(l);const u=l.offsetWidth;return(o=s.parentNode)==null||o.removeChild(s),oe=r-u,oe},qt=(...t)=>o=>{t.forEach(s=>{me(s)?s(o):s.value=o})},zt=(t,o,s,r)=>{let l={offsetX:0,offsetY:0};const u=b=>{const w=b.clientX,y=b.clientY,{offsetX:F,offsetY:n}=l,d=t.value.getBoundingClientRect(),a=d.left,f=d.top,p=d.width,D=d.height,i=document.documentElement.clientWidth,E=document.documentElement.clientHeight,M=-a+F,v=-f+n,h=i-a-p+F,U=E-f-D+n,O=C=>{let A=F+C.clientX-w,H=n+C.clientY-y;r!=null&&r.value||(A=Math.min(Math.max(A,M),h),H=Math.min(Math.max(H,v),U)),l={offsetX:A,offsetY:H},t.value&&(t.value.style.transform=`translate(${re(A)}, ${re(H)})`)},W=()=>{document.removeEventListener("mousemove",O),document.removeEventListener("mouseup",W)};document.addEventListener("mousemove",O),document.addEventListener("mouseup",W)},c=()=>{o.value&&t.value&&o.value.addEventListener("mousedown",u)},$=()=>{o.value&&t.value&&o.value.removeEventListener("mousedown",u)},m=()=>{l={offsetX:0,offsetY:0},t.value&&(t.value.style.transform="none")};return Fe(()=>{Je(()=>{s.value?c():$()})}),De(()=>{$()}),{resetPosition:m}},jt=(t,o={})=>{Ze(t)||ae("[useLockscreen]","You need to pass a ref param to this function");const s=o.ns||G("popup"),r=B(()=>s.bm("parent","hidden"));if(!ve||he(document.body,r.value))return;let l=0,u=!1,c="0";const $=()=>{setTimeout(()=>{typeof document>"u"||(et(document==null?void 0:document.body,r.value),u&&document&&(document.body.style.width=c))},200)};se(t,m=>{if(!m){$();return}u=!he(document.body,r.value),u&&(c=document.body.style.width),l=Nt(s.namespace.value);const b=document.documentElement.clientHeight<document.body.scrollHeight,w=Qe(document.body,"overflowY");l>0&&(b||w==="scroll")&&u&&(document.body.style.width=`calc(100% - ${l}px)`),xe(document.body,r.value)}),tt(()=>$())},We=t=>{if(!t)return{onClick:N,onMousedown:N,onMouseup:N};let o=!1,s=!1;return{onClick:c=>{o&&s&&t(c),o=s=!1},onMousedown:c=>{o=c.target===c.currentTarget},onMouseup:c=>{s=c.target===c.currentTarget}}},Wt=J({mask:{type:Boolean,default:!0},customMaskEvent:Boolean,overlayClass:{type:L([String,Array,Object])},zIndex:{type:L([String,Number])}}),Ht={click:t=>t instanceof MouseEvent},Vt="overlay";var Yt=j({name:"ElOverlay",props:Wt,emits:Ht,setup(t,{slots:o,emit:s}){const r=G(Vt),l=m=>{s("click",m)},{onClick:u,onMousedown:c,onMouseup:$}=We(t.customMaskEvent?void 0:l);return()=>t.mask?S("div",{class:[r.b(),t.overlayClass],style:{zIndex:t.zIndex},onClick:u,onMousedown:c,onMouseup:$},[R(o,"default")],le.STYLE|le.CLASS|le.PROPS,["onClick","onMouseup","onMousedown"]):st("div",{class:t.overlayClass,style:{zIndex:t.zIndex,position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"}},[R(o,"default")])}});const Kt=Yt,He=Symbol("dialogInjectionKey"),Ve=J({center:Boolean,alignCenter:Boolean,closeIcon:{type:ot},draggable:Boolean,overflow:Boolean,fullscreen:Boolean,showClose:{type:Boolean,default:!0},title:{type:String,default:""},ariaLevel:{type:String,default:"2"}}),Xt={close:()=>!0},Gt=j({name:"ElDialogContent"}),Jt=j({...Gt,props:Ve,emits:Xt,setup(t,{expose:o}){const s=t,{t:r}=Re(),{Close:l}=nt,{dialogRef:u,headerRef:c,bodyId:$,ns:m,style:b}=ie(He),{focusTrapRef:w}=ie(at),y=B(()=>[m.b(),m.is("fullscreen",s.fullscreen),m.is("draggable",s.draggable),m.is("align-center",s.alignCenter),{[m.m("center")]:s.center}]),F=qt(w,u),n=B(()=>s.draggable),d=B(()=>s.overflow),{resetPosition:a}=zt(u,c,n,d);return o({resetPosition:a}),(f,p)=>(g(),T("div",{ref:e(F),class:k(e(y)),style:K(e(b)),tabindex:"-1"},[I("header",{ref_key:"headerRef",ref:c,class:k([e(m).e("header"),{"show-close":f.showClose}])},[R(f.$slots,"header",{},()=>[I("span",{role:"heading","aria-level":f.ariaLevel,class:k(e(m).e("title"))},X(f.title),11,["aria-level"])]),f.showClose?(g(),T("button",{key:0,"aria-label":e(r)("el.dialog.close"),class:k(e(m).e("headerbtn")),type:"button",onClick:D=>f.$emit("close")},[S(e(Y),{class:k(e(m).e("close"))},{default:P(()=>[(g(),z(Be(f.closeIcon||e(l))))]),_:1},8,["class"])],10,["aria-label","onClick"])):_("v-if",!0)],2),I("div",{id:e($),class:k(e(m).e("body"))},[R(f.$slots,"default")],10,["id"]),f.$slots.footer?(g(),T("footer",{key:0,class:k(e(m).e("footer"))},[R(f.$slots,"footer")],2)):_("v-if",!0)],6))}});var Zt=ee(Jt,[["__file","dialog-content.vue"]]);const Qt=J({...Ve,appendToBody:Boolean,appendTo:{type:L([String,Object]),default:"body"},beforeClose:{type:L(Function)},destroyOnClose:Boolean,closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},modal:{type:Boolean,default:!0},openDelay:{type:Number,default:0},closeDelay:{type:Number,default:0},top:{type:String},modelValue:Boolean,modalClass:String,width:{type:[String,Number]},zIndex:{type:Number},trapFocus:Boolean,headerAriaLevel:{type:String,default:"2"}}),xt={open:()=>!0,opened:()=>!0,close:()=>!0,closed:()=>!0,[je]:t=>lt(t),openAutoFocus:()=>!0,closeAutoFocus:()=>!0},es=(t,o)=>{var s;const l=ft().emit,{nextZIndex:u}=rt();let c="";const $=be(),m=be(),b=q(!1),w=q(!1),y=q(!1),F=q((s=t.zIndex)!=null?s:u());let n,d;const a=it("namespace",ut),f=B(()=>{const V={},x=`--${a.value}-dialog`;return t.fullscreen||(t.top&&(V[`${x}-margin-top`]=t.top),t.width&&(V[`${x}-width`]=re(t.width))),V}),p=B(()=>t.alignCenter?{display:"flex"}:{});function D(){l("opened")}function i(){l("closed"),l(je,!1),t.destroyOnClose&&(y.value=!1)}function E(){l("close")}function M(){d==null||d(),n==null||n(),t.openDelay&&t.openDelay>0?{stop:n}=ke(()=>O(),t.openDelay):O()}function v(){n==null||n(),d==null||d(),t.closeDelay&&t.closeDelay>0?{stop:d}=ke(()=>W(),t.closeDelay):W()}function h(){function V(x){x||(w.value=!0,b.value=!1)}t.beforeClose?t.beforeClose(V):v()}function U(){t.closeOnClickModal&&h()}function O(){ve&&(b.value=!0)}function W(){b.value=!1}function C(){l("openAutoFocus")}function A(){l("closeAutoFocus")}function H(V){var x;((x=V.detail)==null?void 0:x.focusReason)==="pointer"&&V.preventDefault()}t.lockScroll&&jt(b);function Z(){t.closeOnPressEscape&&h()}return se(()=>t.modelValue,V=>{V?(w.value=!1,M(),y.value=!0,F.value=ct(t.zIndex)?u():F.value++,dt(()=>{l("open"),o.value&&(o.value.scrollTop=0)})):b.value&&v()}),se(()=>t.fullscreen,V=>{o.value&&(V?(c=o.value.style.transform,o.value.style.transform=""):o.value.style.transform=c)}),Fe(()=>{t.modelValue&&(b.value=!0,y.value=!0,M())}),{afterEnter:D,afterLeave:i,beforeLeave:E,handleClose:h,onModalClick:U,close:v,doClose:W,onOpenAutoFocus:C,onCloseAutoFocus:A,onCloseRequested:Z,onFocusoutPrevented:H,titleId:$,bodyId:m,closed:w,style:f,overlayDialogStyle:p,rendered:y,visible:b,zIndex:F}},ts=j({name:"ElDialog",inheritAttrs:!1}),ss=j({...ts,props:Qt,emits:xt,setup(t,{expose:o}){const s=t,r=pt();vt({scope:"el-dialog",from:"the title slot",replacement:"the header slot",version:"3.0.0",ref:"https://element-plus.org/en-US/component/dialog.html#slots"},B(()=>!!r.title));const l=G("dialog"),u=q(),c=q(),$=q(),{visible:m,titleId:b,bodyId:w,style:y,overlayDialogStyle:F,rendered:n,zIndex:d,afterEnter:a,afterLeave:f,beforeLeave:p,handleClose:D,onModalClick:i,onOpenAutoFocus:E,onCloseAutoFocus:M,onCloseRequested:v,onFocusoutPrevented:h}=es(s,u);Ie(He,{dialogRef:u,headerRef:c,bodyId:w,ns:l,rendered:n,style:y});const U=We(i),O=B(()=>s.draggable&&!s.fullscreen);return o({visible:m,dialogContentRef:$,resetPosition:()=>{var C;(C=$.value)==null||C.resetPosition()}}),(C,A)=>(g(),z(e(bt),{to:C.appendTo,disabled:C.appendTo!=="body"?!1:!C.appendToBody},{default:P(()=>[S(mt,{name:"dialog-fade",onAfterEnter:e(a),onAfterLeave:e(f),onBeforeLeave:e(p),persisted:""},{default:P(()=>[yt(S(e(Kt),{"custom-mask-event":"",mask:C.modal,"overlay-class":C.modalClass,"z-index":e(d)},{default:P(()=>[I("div",{role:"dialog","aria-modal":"true","aria-label":C.title||void 0,"aria-labelledby":C.title?void 0:e(b),"aria-describedby":e(w),class:k(`${e(l).namespace.value}-overlay-dialog`),style:K(e(F)),onClick:e(U).onClick,onMousedown:e(U).onMousedown,onMouseup:e(U).onMouseup},[S(e(gt),{loop:"",trapped:e(m),"focus-start-el":"container",onFocusAfterTrapped:e(E),onFocusAfterReleased:e(M),onFocusoutPrevented:e(h),onReleaseRequested:e(v)},{default:P(()=>[e(n)?(g(),z(Zt,ue({key:0,ref_key:"dialogContentRef",ref:$},C.$attrs,{center:C.center,"align-center":C.alignCenter,"close-icon":C.closeIcon,draggable:e(O),overflow:C.overflow,fullscreen:C.fullscreen,"show-close":C.showClose,title:C.title,"aria-level":C.headerAriaLevel,onClose:e(D)}),ce({header:P(()=>[C.$slots.title?R(C.$slots,"title",{key:1}):R(C.$slots,"header",{key:0,close:e(D),titleId:e(b),titleClass:e(l).e("title")})]),default:P(()=>[R(C.$slots,"default")]),_:2},[C.$slots.footer?{name:"footer",fn:P(()=>[R(C.$slots,"footer")])}:void 0]),1040,["center","align-center","close-icon","draggable","overflow","fullscreen","show-close","title","aria-level","onClose"])):_("v-if",!0)]),_:3},8,["trapped","onFocusAfterTrapped","onFocusAfterReleased","onFocusoutPrevented","onReleaseRequested"])],46,["aria-label","aria-labelledby","aria-describedby","onClick","onMousedown","onMouseup"])]),_:3},8,["mask","overlay-class","z-index"]),[[ht,e(m)]])]),_:3},8,["onAfterEnter","onAfterLeave","onBeforeLeave"])]),_:3},8,["to","disabled"]))}});var os=ee(ss,[["__file","dialog.vue"]]);const as=ye(os),ns=J({type:{type:String,default:"line",values:["line","circle","dashboard"]},percentage:{type:Number,default:0,validator:t=>t>=0&&t<=100},status:{type:String,default:"",values:["","success","exception","warning"]},indeterminate:Boolean,duration:{type:Number,default:3},strokeWidth:{type:Number,default:6},strokeLinecap:{type:L(String),default:"round"},textInside:Boolean,width:{type:Number,default:126},showText:{type:Boolean,default:!0},color:{type:L([String,Array,Function]),default:""},striped:Boolean,stripedFlow:Boolean,format:{type:L(Function),default:t=>`${t}%`}}),ls=j({name:"ElProgress"}),rs=j({...ls,props:ns,setup(t){const o=t,s={success:"#13ce66",exception:"#ff4949",warning:"#e6a23c",default:"#20a0ff"},r=G("progress"),l=B(()=>{const i={width:`${o.percentage}%`,animationDuration:`${o.duration}s`},E=D(o.percentage);return E.includes("gradient")?i.background=E:i.backgroundColor=E,i}),u=B(()=>(o.strokeWidth/o.width*100).toFixed(1)),c=B(()=>["circle","dashboard"].includes(o.type)?Number.parseInt(`${50-Number.parseFloat(u.value)/2}`,10):0),$=B(()=>{const i=c.value,E=o.type==="dashboard";return`
          M 50 50
          m 0 ${E?"":"-"}${i}
          a ${i} ${i} 0 1 1 0 ${E?"-":""}${i*2}
          a ${i} ${i} 0 1 1 0 ${E?"":"-"}${i*2}
          `}),m=B(()=>2*Math.PI*c.value),b=B(()=>o.type==="dashboard"?.75:1),w=B(()=>`${-1*m.value*(1-b.value)/2}px`),y=B(()=>({strokeDasharray:`${m.value*b.value}px, ${m.value}px`,strokeDashoffset:w.value})),F=B(()=>({strokeDasharray:`${m.value*b.value*(o.percentage/100)}px, ${m.value}px`,strokeDashoffset:w.value,transition:"stroke-dasharray 0.6s ease 0s, stroke 0.6s ease, opacity ease 0.6s"})),n=B(()=>{let i;return o.color?i=D(o.percentage):i=s[o.status]||s.default,i}),d=B(()=>o.status==="warning"?kt:o.type==="line"?o.status==="success"?Ue:wt:o.status==="success"?ge:Me),a=B(()=>o.type==="line"?12+o.strokeWidth*.4:o.width*.111111+2),f=B(()=>o.format(o.percentage));function p(i){const E=100/i.length;return i.map((v,h)=>we(v)?{color:v,percentage:(h+1)*E}:v).sort((v,h)=>v.percentage-h.percentage)}const D=i=>{var E;const{color:M}=o;if(me(M))return M(i);if(we(M))return M;{const v=p(M);for(const h of v)if(h.percentage>i)return h.color;return(E=v[v.length-1])==null?void 0:E.color}};return(i,E)=>(g(),T("div",{class:k([e(r).b(),e(r).m(i.type),e(r).is(i.status),{[e(r).m("without-text")]:!i.showText,[e(r).m("text-inside")]:i.textInside}]),role:"progressbar","aria-valuenow":i.percentage,"aria-valuemin":"0","aria-valuemax":"100"},[i.type==="line"?(g(),T("div",{key:0,class:k(e(r).b("bar"))},[I("div",{class:k(e(r).be("bar","outer")),style:K({height:`${i.strokeWidth}px`})},[I("div",{class:k([e(r).be("bar","inner"),{[e(r).bem("bar","inner","indeterminate")]:i.indeterminate},{[e(r).bem("bar","inner","striped")]:i.striped},{[e(r).bem("bar","inner","striped-flow")]:i.stripedFlow}]),style:K(e(l))},[(i.showText||i.$slots.default)&&i.textInside?(g(),T("div",{key:0,class:k(e(r).be("bar","innerText"))},[R(i.$slots,"default",{percentage:i.percentage},()=>[I("span",null,X(e(f)),1)])],2)):_("v-if",!0)],6)],6)],2)):(g(),T("div",{key:1,class:k(e(r).b("circle")),style:K({height:`${i.width}px`,width:`${i.width}px`})},[(g(),T("svg",{viewBox:"0 0 100 100"},[I("path",{class:k(e(r).be("circle","track")),d:e($),stroke:`var(${e(r).cssVarName("fill-color-light")}, #e5e9f2)`,"stroke-linecap":i.strokeLinecap,"stroke-width":e(u),fill:"none",style:K(e(y))},null,14,["d","stroke","stroke-linecap","stroke-width"]),I("path",{class:k(e(r).be("circle","path")),d:e($),stroke:e(n),fill:"none",opacity:i.percentage?1:0,"stroke-linecap":i.strokeLinecap,"stroke-width":e(u),style:K(e(F))},null,14,["d","stroke","opacity","stroke-linecap","stroke-width"])]))],6)),(i.showText||i.$slots.default)&&!i.textInside?(g(),T("div",{key:2,class:k(e(r).e("text")),style:K({fontSize:`${e(a)}px`})},[R(i.$slots,"default",{percentage:i.percentage},()=>[i.status?(g(),z(e(Y),{key:1},{default:P(()=>[(g(),z(Be(e(d))))]),_:1})):(g(),T("span",{key:0},X(e(f)),1))])],6)):_("v-if",!0)],10,["aria-valuenow"]))}});var is=ee(rs,[["__file","progress.vue"]]);const us=ye(is),Ye=Symbol("uploadContextKey"),cs="ElUpload";class ds extends Error{constructor(o,s,r,l){super(o),this.name="UploadAjaxError",this.status=s,this.method=r,this.url=l}}function Le(t,o,s){let r;return s.response?r=`${s.response.error||s.response}`:s.responseText?r=`${s.responseText}`:r=`fail to ${o.method} ${t} ${s.status}`,new ds(r,s.status,o.method,t)}function fs(t){const o=t.responseText||t.response;if(!o)return o;try{return JSON.parse(o)}catch{return o}}const ps=t=>{typeof XMLHttpRequest>"u"&&ae(cs,"XMLHttpRequest is undefined");const o=new XMLHttpRequest,s=t.action;o.upload&&o.upload.addEventListener("progress",u=>{const c=u;c.percent=u.total>0?u.loaded/u.total*100:0,t.onProgress(c)});const r=new FormData;if(t.data)for(const[u,c]of Object.entries(t.data))Oe(c)&&c.length?r.append(u,...c):r.append(u,c);r.append(t.filename,t.file,t.file.name),o.addEventListener("error",()=>{t.onError(Le(s,t,o))}),o.addEventListener("load",()=>{if(o.status<200||o.status>=300)return t.onError(Le(s,t,o));t.onSuccess(fs(o))}),o.open(t.method,s,!0),t.withCredentials&&"withCredentials"in o&&(o.withCredentials=!0);const l=t.headers||{};if(l instanceof Headers)l.forEach((u,c)=>o.setRequestHeader(c,u));else for(const[u,c]of Object.entries(l))Ae(c)||o.setRequestHeader(u,String(c));return o.send(r),o},Ke=["text","picture","picture-card"];let vs=1;const pe=()=>Date.now()+vs++,Xe=J({action:{type:String,default:"#"},headers:{type:L(Object)},method:{type:String,default:"post"},data:{type:L([Object,Function,Promise]),default:()=>de({})},multiple:Boolean,name:{type:String,default:"file"},drag:Boolean,withCredentials:Boolean,showFileList:{type:Boolean,default:!0},accept:{type:String,default:""},fileList:{type:L(Array),default:()=>de([])},autoUpload:{type:Boolean,default:!0},listType:{type:String,values:Ke,default:"text"},httpRequest:{type:L(Function),default:ps},disabled:Boolean,limit:Number}),ms=J({...Xe,beforeUpload:{type:L(Function),default:N},beforeRemove:{type:L(Function)},onRemove:{type:L(Function),default:N},onChange:{type:L(Function),default:N},onPreview:{type:L(Function),default:N},onSuccess:{type:L(Function),default:N},onProgress:{type:L(Function),default:N},onError:{type:L(Function),default:N},onExceed:{type:L(Function),default:N},crossorigin:{type:L(String)}}),ys=J({files:{type:L(Array),default:()=>de([])},disabled:{type:Boolean,default:!1},handlePreview:{type:L(Function),default:N},listType:{type:String,values:Ke,default:"text"},crossorigin:{type:L(String)}}),gs={remove:t=>!!t},hs=j({name:"ElUploadList"}),bs=j({...hs,props:ys,emits:gs,setup(t,{emit:o}){const s=t,{t:r}=Re(),l=G("upload"),u=G("icon"),c=G("list"),$=ne(),m=q(!1),b=B(()=>[l.b("list"),l.bm("list",s.listType),l.is("disabled",s.disabled)]),w=y=>{o("remove",y)};return(y,F)=>(g(),z(Lt,{tag:"ul",class:k(e(b)),name:e(c).b()},{default:P(()=>[(g(!0),T(Ct,null,$t(y.files,(n,d)=>(g(),T("li",{key:n.uid||n.name,class:k([e(l).be("list","item"),e(l).is(n.status),{focusing:m.value}]),tabindex:"0",onKeydown:Ne(a=>!e($)&&w(n),["delete"]),onFocus:a=>m.value=!0,onBlur:a=>m.value=!1,onClick:a=>m.value=!1},[R(y.$slots,"default",{file:n,index:d},()=>[y.listType==="picture"||n.status!=="uploading"&&y.listType==="picture-card"?(g(),T("img",{key:0,class:k(e(l).be("list","item-thumbnail")),src:n.url,crossorigin:y.crossorigin,alt:""},null,10,["src","crossorigin"])):_("v-if",!0),n.status==="uploading"||y.listType!=="picture-card"?(g(),T("div",{key:1,class:k(e(l).be("list","item-info"))},[I("a",{class:k(e(l).be("list","item-name")),onClick:te(a=>y.handlePreview(n),["prevent"])},[S(e(Y),{class:k(e(u).m("document"))},{default:P(()=>[S(e(Et))]),_:1},8,["class"]),I("span",{class:k(e(l).be("list","item-file-name")),title:n.name},X(n.name),11,["title"])],10,["onClick"]),n.status==="uploading"?(g(),z(e(us),{key:0,type:y.listType==="picture-card"?"circle":"line","stroke-width":y.listType==="picture-card"?6:2,percentage:Number(n.percentage),style:K(y.listType==="picture-card"?"":"margin-top: 0.5rem")},null,8,["type","stroke-width","percentage","style"])):_("v-if",!0)],2)):_("v-if",!0),I("label",{class:k(e(l).be("list","item-status-label"))},[y.listType==="text"?(g(),z(e(Y),{key:0,class:k([e(u).m("upload-success"),e(u).m("circle-check")])},{default:P(()=>[S(e(Ue))]),_:1},8,["class"])):["picture-card","picture"].includes(y.listType)?(g(),z(e(Y),{key:1,class:k([e(u).m("upload-success"),e(u).m("check")])},{default:P(()=>[S(e(ge))]),_:1},8,["class"])):_("v-if",!0)],2),e($)?_("v-if",!0):(g(),z(e(Y),{key:2,class:k(e(u).m("close")),onClick:a=>w(n)},{default:P(()=>[S(e(Me))]),_:2},1032,["class","onClick"])),_(" Due to close btn only appears when li gets focused disappears after li gets blurred, thus keyboard navigation can never reach close btn"),_(" This is a bug which needs to be fixed "),_(" TODO: Fix the incorrect navigation interaction "),e($)?_("v-if",!0):(g(),T("i",{key:3,class:k(e(u).m("close-tip"))},X(e(r)("el.upload.deleteTip")),3)),y.listType==="picture-card"?(g(),T("span",{key:4,class:k(e(l).be("list","item-actions"))},[I("span",{class:k(e(l).be("list","item-preview")),onClick:a=>y.handlePreview(n)},[S(e(Y),{class:k(e(u).m("zoom-in"))},{default:P(()=>[S(e(qe))]),_:1},8,["class"])],10,["onClick"]),e($)?_("v-if",!0):(g(),T("span",{key:0,class:k(e(l).be("list","item-delete")),onClick:a=>w(n)},[S(e(Y),{class:k(e(u).m("delete"))},{default:P(()=>[S(e(ze))]),_:1},8,["class"])],10,["onClick"]))],2)):_("v-if",!0)])],42,["onKeydown","onFocus","onBlur","onClick"]))),128)),R(y.$slots,"append")]),_:3},8,["class","name"]))}});var Pe=ee(bs,[["__file","upload-list.vue"]]);const ks=J({disabled:{type:Boolean,default:!1}}),ws={file:t=>Oe(t)},Ge="ElUploadDrag",Cs=j({name:Ge}),$s=j({...Cs,props:ks,emits:ws,setup(t,{emit:o}){ie(Ye)||ae(Ge,"usage: <el-upload><el-upload-dragger /></el-upload>");const r=G("upload"),l=q(!1),u=ne(),c=m=>{if(u.value)return;l.value=!1,m.stopPropagation();const b=Array.from(m.dataTransfer.files);o("file",b)},$=()=>{u.value||(l.value=!0)};return(m,b)=>(g(),T("div",{class:k([e(r).b("dragger"),e(r).is("dragover",l.value)]),onDrop:te(c,["prevent"]),onDragover:te($,["prevent"]),onDragleave:te(w=>l.value=!1,["prevent"])},[R(m.$slots,"default")],42,["onDrop","onDragover","onDragleave"]))}});var Es=ee($s,[["__file","upload-dragger.vue"]]);const Ls=J({...Xe,beforeUpload:{type:L(Function),default:N},onRemove:{type:L(Function),default:N},onStart:{type:L(Function),default:N},onSuccess:{type:L(Function),default:N},onProgress:{type:L(Function),default:N},onError:{type:L(Function),default:N},onExceed:{type:L(Function),default:N}}),Ps=j({name:"ElUploadContent",inheritAttrs:!1}),Ss=j({...Ps,props:Ls,setup(t,{expose:o}){const s=t,r=G("upload"),l=ne(),u=fe({}),c=fe(),$=a=>{if(a.length===0)return;const{autoUpload:f,limit:p,fileList:D,multiple:i,onStart:E,onExceed:M}=s;if(p&&D.length+a.length>p){M(a,D);return}i||(a=a.slice(0,1));for(const v of a){const h=v;h.uid=pe(),E(h),f&&m(h)}},m=async a=>{if(c.value.value="",!s.beforeUpload)return w(a);let f,p={};try{const i=s.data,E=s.beforeUpload(a);p=Ce(s.data)?Ee(s.data):s.data,f=await E,Ce(s.data)&&Mt(i,p)&&(p=Ee(s.data))}catch{f=!1}if(f===!1){s.onRemove(a);return}let D=a;f instanceof Blob&&(f instanceof File?D=f:D=new File([f],a.name,{type:a.type})),w(Object.assign(D,{uid:a.uid}),p)},b=async(a,f)=>me(a)?a(f):a,w=async(a,f)=>{const{headers:p,data:D,method:i,withCredentials:E,name:M,action:v,onProgress:h,onSuccess:U,onError:O,httpRequest:W}=s;try{f=await b(f??D,a)}catch{s.onRemove(a);return}const{uid:C}=a,A={headers:p||{},withCredentials:E,file:a,data:f,method:i,filename:M,action:v,onProgress:Z=>{h(Z,a)},onSuccess:Z=>{U(Z,a),delete u.value[C]},onError:Z=>{O(Z,a),delete u.value[C]}},H=W(A);u.value[C]=H,H instanceof Promise&&H.then(A.onSuccess,A.onError)},y=a=>{const f=a.target.files;f&&$(Array.from(f))},F=()=>{l.value||(c.value.value="",c.value.click())},n=()=>{F()};return o({abort:a=>{Pt(u.value).filter(a?([p])=>String(a.uid)===p:()=>!0).forEach(([p,D])=>{D instanceof XMLHttpRequest&&D.abort(),delete u.value[p]})},upload:m}),(a,f)=>(g(),T("div",{class:k([e(r).b(),e(r).m(a.listType),e(r).is("drag",a.drag),e(r).is("disabled",e(l))]),tabindex:e(l)?"-1":"0",onClick:F,onKeydown:Ne(te(n,["self"]),["enter","space"])},[a.drag?(g(),z(Es,{key:0,disabled:e(l),onFile:$},{default:P(()=>[R(a.$slots,"default")]),_:3},8,["disabled"])):R(a.$slots,"default",{key:1}),I("input",{ref_key:"inputRef",ref:c,class:k(e(r).e("input")),name:a.name,disabled:e(l),multiple:a.multiple,accept:a.accept,type:"file",onChange:y,onClick:te(()=>{},["stop"])},null,42,["name","disabled","multiple","accept","onClick"])],42,["tabindex","onKeydown"]))}});var Se=ee(Ss,[["__file","upload-content.vue"]]);const _e="ElUpload",Te=t=>{var o;(o=t.url)!=null&&o.startsWith("blob:")&&URL.revokeObjectURL(t.url)},_s=(t,o)=>{const s=St(t,"fileList",void 0,{passive:!0}),r=n=>s.value.find(d=>d.uid===n.uid);function l(n){var d;(d=o.value)==null||d.abort(n)}function u(n=["ready","uploading","success","fail"]){s.value=s.value.filter(d=>!n.includes(d.status))}function c(n){s.value=s.value.filter(d=>d!==n)}const $=(n,d)=>{const a=r(d);a&&(console.error(n),a.status="fail",c(a),t.onError(n,a,s.value),t.onChange(a,s.value))},m=(n,d)=>{const a=r(d);a&&(t.onProgress(n,a,s.value),a.status="uploading",a.percentage=Math.round(n.percent))},b=(n,d)=>{const a=r(d);a&&(a.status="success",a.response=n,t.onSuccess(n,a,s.value),t.onChange(a,s.value))},w=n=>{Ae(n.uid)&&(n.uid=pe());const d={name:n.name,percentage:0,status:"ready",size:n.size,raw:n,uid:n.uid};if(t.listType==="picture-card"||t.listType==="picture")try{d.url=URL.createObjectURL(n)}catch(a){_t(_e,a.message),t.onError(a,d,s.value)}s.value=[...s.value,d],t.onChange(d,s.value)},y=async n=>{const d=n instanceof File?r(n):n;d||ae(_e,"file to be removed not found");const a=f=>{l(f),c(f),t.onRemove(f,s.value),Te(f)};t.beforeRemove?await t.beforeRemove(d,s.value)!==!1&&a(d):a(d)};function F(){s.value.filter(({status:n})=>n==="ready").forEach(({raw:n})=>{var d;return n&&((d=o.value)==null?void 0:d.upload(n))})}return se(()=>t.listType,n=>{n!=="picture-card"&&n!=="picture"||(s.value=s.value.map(d=>{const{raw:a,url:f}=d;if(!f&&a)try{d.url=URL.createObjectURL(a)}catch(p){t.onError(p,d,s.value)}return d}))}),se(s,n=>{for(const d of n)d.uid||(d.uid=pe()),d.status||(d.status="success")},{immediate:!0,deep:!0}),{uploadFiles:s,abort:l,clearFiles:u,handleError:$,handleProgress:m,handleStart:w,handleSuccess:b,handleRemove:y,submit:F,revokeFileObjectURL:Te}},Ts=j({name:"ElUpload"}),Fs=j({...Ts,props:ms,setup(t,{expose:o}){const s=t,r=ne(),l=fe(),{abort:u,submit:c,clearFiles:$,uploadFiles:m,handleStart:b,handleError:w,handleRemove:y,handleSuccess:F,handleProgress:n,revokeFileObjectURL:d}=_s(s,l),a=B(()=>s.listType==="picture-card"),f=B(()=>({...s,fileList:m.value,onStart:b,onProgress:n,onSuccess:F,onError:w,onRemove:y}));return De(()=>{m.value.forEach(d)}),Ie(Ye,{accept:Tt(s,"accept")}),o({abort:u,submit:c,clearFiles:$,handleStart:b,handleRemove:y}),(p,D)=>(g(),T("div",null,[e(a)&&p.showFileList?(g(),z(Pe,{key:0,disabled:e(r),"list-type":p.listType,files:e(m),crossorigin:p.crossorigin,"handle-preview":p.onPreview,onRemove:e(y)},ce({append:P(()=>[S(Se,ue({ref_key:"uploadRef",ref:l},e(f)),{default:P(()=>[p.$slots.trigger?R(p.$slots,"trigger",{key:0}):_("v-if",!0),!p.$slots.trigger&&p.$slots.default?R(p.$slots,"default",{key:1}):_("v-if",!0)]),_:3},16)]),_:2},[p.$slots.file?{name:"default",fn:P(({file:i,index:E})=>[R(p.$slots,"file",{file:i,index:E})])}:void 0]),1032,["disabled","list-type","files","crossorigin","handle-preview","onRemove"])):_("v-if",!0),!e(a)||e(a)&&!p.showFileList?(g(),z(Se,ue({key:1,ref_key:"uploadRef",ref:l},e(f)),{default:P(()=>[p.$slots.trigger?R(p.$slots,"trigger",{key:0}):_("v-if",!0),!p.$slots.trigger&&p.$slots.default?R(p.$slots,"default",{key:1}):_("v-if",!0)]),_:3},16)):_("v-if",!0),p.$slots.trigger?R(p.$slots,"default",{key:2}):_("v-if",!0),R(p.$slots,"tip"),!e(a)&&p.showFileList?(g(),z(Pe,{key:3,disabled:e(r),"list-type":p.listType,files:e(m),crossorigin:p.crossorigin,"handle-preview":p.onPreview,onRemove:e(y)},ce({_:2},[p.$slots.file?{name:"default",fn:P(({file:i,index:E})=>[R(p.$slots,"file",{file:i,index:E})])}:void 0]),1032,["disabled","list-type","files","crossorigin","handle-preview","onRemove"])):_("v-if",!0)]))}});var Ds=ee(Fs,[["__file","upload.vue"]]);const Rs=ye(Ds),Bs={class:"container mx-auto flex flex-col items-center max-h-screen p-4 space-y-4"},Is={key:1,class:"space-y-4"},Us={class:"text-center mb-4"},Ms={class:"text-gray-600"},Os={key:0,class:"upload-trigger"},As={key:1,class:"upload-trigger"},Ns=["src"],qs={class:"el-upload-list__item-actions"},zs=["onClick"],js=["onClick"],Ws={key:2,class:"flex justify-center my-6"},Hs={key:3,class:"flex items-center justify-center w-full"},Vs={key:0},Ys={key:1,class:"text-center text-gray-500"},Ks=["src"],Xs={__name:"ImageUploadPredictor",props:{imageLimit:{type:Number,required:!0},selectedDate:{type:[Date,String],required:!0},getPredictionResult:{type:Function,required:!0},submitPredictionRequest:{type:Function,required:!0}},emits:["update:selectedDate"],setup(t,{emit:o}){const s=t,r=o,l=q([]),u=q(!1),c=q([]),$=q(""),m=q(!1),b=q([]),w=q(!1),y=q(null),F=q(null);se(c,v=>{v.length===s.imageLimit&&Q.success(`已成功选择${s.imageLimit}张图片`)});const n=v=>new Promise((h,U)=>{const O=new FileReader;O.readAsDataURL(v),O.onload=()=>h(O.result),O.onerror=W=>U(W)}),d=v=>v.type==="image/png"?c.value.length>=s.imageLimit?(Q.error(`已达到${s.imageLimit}张图片上限`),!1):!0:(Q.error("仅支持PNG文件"),!1),a=(v,h)=>{const U=v.image_url;U&&b.value.push(U),Q.success(`${h.name} 上传成功`)},f=(v,h)=>{Q.error(`${h.name} 上传失败`),console.error("Upload error:",v)},p=async v=>{!v.url&&!v.preview&&(v.preview=await n(v.raw)),$.value=v.url||v.preview,m.value=!0},D=v=>{c.value=c.value.filter(U=>U.uid!==v.uid);const h=c.value.findIndex(U=>U.uid===v.uid);h!==-1&&b.value.splice(h,1),Q.warning(`还需上传${s.imageLimit-c.value.length}张图片`)},i=async()=>{if(y.value)try{const v=await s.getPredictionResult(y.value);v.length!=0&&(l.value=v,u.value=!0,clearInterval(F.value),w.value=!1)}catch(v){if(v.response&&v.response.status===400){console.log("Task not completed yet, continuing polling...");return}clearInterval(F.value),w.value=!1,Q.error("获取预测结果失败"),console.error("Error:",v)}},E=async()=>{try{w.value=!0;const v=await s.submitPredictionRequest(s.selectedDate,b.value);y.value=v.task_id,F.value=setInterval(i,2e3)}catch(v){w.value=!1,Q.error("提交预测请求失败"),console.error("Error:",v)}},M=()=>{u.value=!1,l.value=[],c.value=[],b.value=[],y.value=null,F.value&&clearInterval(F.value),r("update:selectedDate",null)};return(v,h)=>{const U=It,O=Y,W=Rs,C=as;return g(),T("div",Bs,[u.value?(g(),z(U,{key:0,class:"self-start",onClick:M},{default:P(()=>h[2]||(h[2]=[$e(" 返回 ")])),_:1})):_("",!0),u.value?_("",!0):(g(),T("div",Is,[I("div",Us,[I("p",Ms," 请上传正好"+X(t.imageLimit)+"张PNG图片 (已上传: "+X(c.value.length)+"/"+X(t.imageLimit)+") ",1)]),S(W,{"file-list":c.value,"onUpdate:fileList":h[0]||(h[0]=A=>c.value=A),class:"upload-demo",action:"https://seaice.52lxy.one:20443/seaice/png-upload",accept:".png","list-type":"picture-card",multiple:!0,limit:t.imageLimit,"before-upload":d,"on-preview":p,"on-success":a,"on-error":f,"on-remove":D,"auto-upload":!0},{default:P(()=>[c.value.length<t.imageLimit?(g(),T("div",Os,[S(O,{class:"upload-icon"},{default:P(()=>[S(e(Dt))]),_:1}),h[3]||(h[3]=I("div",{class:"upload-text"},"上传",-1))])):(g(),T("div",As,[S(O,{class:"upload-icon text-green-500"},{default:P(()=>[S(e(ge))]),_:1}),h[4]||(h[4]=I("div",{class:"upload-text text-green-500"},"已完成",-1))]))]),file:P(({file:A})=>[I("div",null,[I("img",{class:"el-upload-list__item-thumbnail",src:A.url,alt:""},null,8,Ns),I("span",qs,[I("span",{class:"el-upload-list__item-preview",onClick:H=>p(A)},[S(O,null,{default:P(()=>[S(e(qe))]),_:1})],8,zs),I("span",{class:"el-upload-list__item-delete",onClick:H=>D(A)},[S(O,null,{default:P(()=>[S(e(ze))]),_:1})],8,js)])])]),_:1},8,["file-list","limit"]),R(v.$slots,"date-picker",{},void 0,!0),S(U,{type:"primary",onClick:E,loading:w.value,disabled:c.value.length!==t.imageLimit||!t.selectedDate||b.value.length!==t.imageLimit},{default:P(()=>[$e(X(w.value?"分析中...":"提交分析"),1)]),_:1},8,["loading","disabled"])])),w.value?(g(),T("div",Ws,[S(Rt)])):_("",!0),!w.value&&u.value?(g(),T("div",Hs,[l.value.length?(g(),T("div",Vs,[S(Bt,{images:l.value},null,8,["images"])])):(g(),T("div",Ys,"请上传图片并选择日期以查看预测结果"))])):_("",!0),S(C,{modelValue:m.value,"onUpdate:modelValue":h[1]||(h[1]=A=>m.value=A),title:"预览"},{default:P(()=>[I("img",{"w-full":"",src:$.value,alt:"Preview Image"},null,8,Ks)]),_:1},8,["modelValue"])])}}},Zs=Ft(Xs,[["__scopeId","data-v-806ef5cd"]]);export{Zs as I};
