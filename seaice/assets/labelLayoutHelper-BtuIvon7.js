import{V as B,W as X}from"./index-yh27qCC3.js";function H(t){for(var r=[],u=0;u<t.length;u++){var v=t[u];if(!v.defaultAttr.ignore){var d=v.label,f=d.getComputedTransform(),e=d.getBoundingRect(),O=!f||f[1]<1e-5&&f[2]<1e-5,p=d.style.margin||0,i=e.clone();i.applyTransform(f),i.x-=p/2,i.y-=p/2,i.width+=p,i.height+=p;var g=O?new B(e,f):null;r.push({label:d,labelLine:v.labelLine,rect:i,localRect:e,obb:g,priority:v.priority,defaultAttr:v.defaultAttr,layoutOption:v.computedLayoutOption,axisAligned:O,transform:f})}}return r}function V(t,r,u,v,d,f){var e=t.length;if(e<2)return;t.sort(function(a,y){return a.rect[r]-y.rect[r]});for(var O=0,p,i=!1,g=0;g<e;g++){var G=t[g],A=G.rect;p=A[r]-O,p<0&&(A[r]-=p,G.label[r]-=p,i=!0),O=A[r]+A[u]}var k=t[0],L=t[e-1],c,s;b(),c<0&&M(-c,.8),s<0&&M(s,.8),b(),E(c,s,1),E(s,c,-1),b(),c<0&&P(-c),s<0&&P(s);function b(){c=k.rect[r]-v,s=d-L.rect[r]-L.rect[u]}function E(a,y,h){if(a<0){var o=Math.min(y,-a);if(o>0){q(o*h,0,e);var n=o+a;n<0&&M(-n*h,1)}else M(-a*h,1)}}function q(a,y,h){a!==0&&(i=!0);for(var o=y;o<h;o++){var n=t[o],S=n.rect;S[r]+=a,n.label[r]+=a}}function M(a,y){for(var h=[],o=0,n=1;n<e;n++){var S=t[n-1].rect,W=Math.max(t[n].rect[r]-S[r]-S[u],0);h.push(W),o+=W}if(o){var z=Math.min(Math.abs(a)/o,y);if(a>0)for(var n=0;n<e-1;n++){var w=h[n]*z;q(w,0,n+1)}else for(var n=e-1;n>0;n--){var w=h[n-1]*z;q(-w,n,e)}}}function P(a){var y=a<0?-1:1;a=Math.abs(a);for(var h=Math.ceil(a/(e-1)),o=0;o<e-1;o++)if(y>0?q(h,0,o+1):q(-h,e-o-1,e),a-=h,a<=0)return}return i}function J(t,r,u,v){return V(t,"x","width",r,u)}function K(t,r,u,v){return V(t,"y","height",r,u)}function N(t){var r=[];t.sort(function(c,s){return s.priority-c.priority});var u=new X(0,0,0,0);function v(c){if(!c.ignore){var s=c.ensureState("emphasis");s.ignore==null&&(s.ignore=!1)}c.ignore=!0}for(var d=0;d<t.length;d++){var f=t[d],e=f.axisAligned,O=f.localRect,p=f.transform,i=f.label,g=f.labelLine;u.copy(f.rect),u.width-=.1,u.height-=.1,u.x+=.05,u.y+=.05;for(var G=f.obb,A=!1,k=0;k<r.length;k++){var L=r[k];if(u.intersect(L.rect)){if(e&&L.axisAligned){A=!0;break}if(L.obb||(L.obb=new B(L.localRect,L.transform)),G||(G=new B(O,p)),G.intersect(L.obb)){A=!0;break}}}A?(v(i),g&&v(g)):(i.attr("ignore",f.defaultAttr.ignore),g&&g.attr("ignore",f.defaultAttr.labelGuideIgnore),r.push(f))}}export{K as a,N as h,H as p,J as s};
