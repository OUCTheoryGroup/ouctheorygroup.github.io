import{_ as j}from"./result_mask-DVoKs7o9.js";import{_ as H,r as h,e as r,g as m,c as M,o as g,a as s,i as _,m as N,x as D,n as R,t as X,j as w,F as T,l as W,A as E,B as G}from"./index-CwjyL_I4.js";const J={class:"resultDisplayContainer"},K={class:"resultContainer"},O={class:"title"},Q={class:"resultList"},Z={class:"taskId"},tt={class:"idBox"},et={class:"tag"},at=["onClick"],st={key:0,class:"iconBox"},lt={key:1,class:"iconBox"},ot={class:"createdTime"},nt={class:"modalBox"},it={class:"title"},ut={class:"content"},rt=["src","onClick"],ct={style:{"text-align":"center",margin:"2px 0"}},dt=["src"],vt={__name:"index",props:{title:{type:String,default:"分析结果"},tooltip:{type:String,default:"查看最近的分析记录"},emptyMessage:{type:String,default:"暂无结果"},taskList:{type:Array,default:()=>[],required:!0},resultList:{type:Array,default:()=>[],required:!0},modalTitle:{type:String,default:"结果详情"}},setup(n){const Y=n,B="https://assets-seaice-eo.52lxy.top",L=h(!1),c=h(null),d=h(null),b=h(!1),t=r(()=>c.value!==null&&Y.resultList[c.value]?Y.resultList[c.value].images||[]:[]),i=e=>{Y.resultList[e]?.status==="完成"&&(L.value=!0,c.value=e)},u=e=>{d.value=e,b.value=!0},v=e=>e?e.startsWith("http")?e:B+e:"";return(e,p)=>{const I=m("vue-fontawesome"),V=m("b-tooltip"),S=m("b-message"),C=m("b-tag"),$=m("b-notification"),k=m("b-modal");return g(),M("div",J,[s("div",K,[s("section",null,[s("h3",O,[R(X(n.title)+" ",1),_(V,{label:n.tooltip,position:"is-bottom",type:"is-dark"},{default:w(()=>[_(I,{icon:"circle-exclamation"})]),_:1},8,["label"])]),n.taskList.length==0?(g(),N(S,{key:0},{default:w(()=>[R(X(n.emptyMessage),1)]),_:1})):D("",!0)]),s("section",Q,[(g(!0),M(T,null,W(n.taskList,(l,f)=>(g(),N($,{closable:!1,key:l.task_id},{default:w(()=>[s("div",Z,[s("span",tt," 任务id: "+X(l.task_id),1),s("span",et,[_(C,{type:n.resultList[f]?.status==="完成"?"is-success is-light":"is-warning is-light"},{default:w(()=>[R(X(n.resultList[f]?.status),1)]),_:2},1032,["type"])])]),s("div",{class:"resultMask",onClick:U=>i(f)},[p[2]||(p[2]=s("img",{src:j,alt:""},null,-1)),n.resultList[f]?.status==="完成"?(g(),M("span",st,[_(I,{class:"eyeIcon",icon:"eye"})])):(g(),M("span",lt,[_(I,{class:"eyeIcon",icon:"eye-slash"})]))],8,at),s("div",ot," 提交时间: "+X(l.created_time),1)]),_:2},1024))),128))])]),_(k,{modelValue:L.value,"onUpdate:modelValue":p[0]||(p[0]=l=>L.value=l)},{default:w(()=>[s("div",nt,[s("h3",it,X(n.modalTitle),1),s("div",ut,[(g(!0),M(T,null,W(t.value,(l,f)=>(g(),M("li",{class:"imgItem",key:f},[s("img",{src:v(l?.path||l),alt:"Result Image",onClick:U=>u(l?.path||l)},null,8,rt),s("p",ct,X(l?.date),1)]))),128))])])]),_:1},8,["modelValue"]),_(k,{modelValue:b.value,"onUpdate:modelValue":p[1]||(p[1]=l=>b.value=l),class:"previewModal"},{default:w(()=>[s("div",null,[s("img",{src:v(d.value),alt:"Preview Image"},null,8,dt)])]),_:1},8,["modelValue"])])}}},yt=H(vt,[["__scopeId","data-v-c786353f"]]),ht={class:"image-selector-container"},gt={class:"info-area"},_t=["src"],mt={__name:"index",props:{imageUrl:{type:String,required:!0},width:{type:Number,default:432},height:{type:Number,default:432}},emits:["selection-string"],setup(n,{emit:Y}){const B=n,L=Y,c=h(null),d=h(null),b=h(!1),t=E({active:!1,x:0,y:0,width:0,height:0,startX:0,startY:0}),i=h(0),u=h(0),v=h(0),e=h(0),p=()=>{if(c.value){const a=c.value.getBoundingClientRect();a.left,a.top}d.value&&(i.value=Math.round(d.value.clientHeight||d.value.naturalHeight||0),u.value=Math.round(d.value.clientWidth||d.value.naturalWidth||0),v.value=d.value.naturalWidth||0,e.value=d.value.naturalHeight||0)},I=a=>{if(a.preventDefault(),!c.value)return;b.value=!0,t.active=!0;const o=c.value.getBoundingClientRect();t.startX=Math.round(a.pageX-o.left-window.scrollX),t.startY=Math.round(a.pageY-o.top-window.scrollY),t.x=t.startX,t.y=t.startY,t.width=0,t.height=0},V=a=>{if(!b.value)return;const o=c.value.getBoundingClientRect(),y=a.pageX-o.left-window.scrollX,x=a.pageY-o.top-window.scrollY;y<t.startX?(t.x=Math.round(y),t.width=Math.round(t.startX-y)):(t.x=Math.round(t.startX),t.width=Math.round(y-t.startX)),x<t.startY?(t.y=Math.round(x),t.height=Math.round(t.startY-x)):(t.y=Math.round(t.startY),t.height=Math.round(x-t.startY))},S=()=>{b.value=!1,t.width===0&&t.height===0?C():A()},C=()=>{t.active=!1,t.width=u.value||v.value||0,t.height=i.value||e.value||0,t.x=0,t.y=0,A()},$=r(()=>({left:`${t.x}px`,top:`${t.y}px`,width:`${t.width}px`,height:`${t.height}px`}));r(()=>({x:Math.round(t.x+t.width),y:Math.round(t.y)})),r(()=>({x:Math.round(t.x),y:Math.round(t.y+t.height)})),r(()=>({x:Math.round(t.x+t.width),y:Math.round(t.y+t.height)}));const k=r(()=>v.value>0?B.width/v.value:1),l=r(()=>e.value>0?B.height/e.value:1),f=r(()=>{const a=u.value>0?t.x/u.value*v.value:t.x,o=i.value>0?t.y/i.value*e.value:t.y;return{x:Math.round(a*k.value),y:Math.round((e.value-o)*l.value)}}),U=r(()=>{const a=u.value>0?(t.x+t.width)/u.value*v.value:t.x+t.width,o=i.value>0?t.y/i.value*e.value:t.y;return{x:Math.round(a*k.value),y:Math.round((e.value-o)*l.value)}}),q=r(()=>{const a=u.value>0?t.x/u.value*v.value:t.x,o=i.value>0?(t.y+t.height)/i.value*e.value:t.y+t.height;return{x:Math.round(a*k.value),y:Math.round((e.value-o)*l.value)}}),z=r(()=>{const a=u.value>0?(t.x+t.width)/u.value*v.value:t.x+t.width,o=i.value>0?(t.y+t.height)/i.value*e.value:t.y+t.height;return{x:Math.round(a*k.value),y:Math.round((e.value-o)*l.value)}}),F=r(()=>{const a=q.value,o=f.value,y=z.value,x=U.value;return{bl:a,tl:o,br:y,tr:x}});function A(){L("selection-string",F.value)}return(a,o)=>{const y=m("b-button"),x=m("vue-fontawesome"),P=m("b-tooltip");return g(),M("div",ht,[s("div",gt,[_(y,{onClick:C,size:"is-small"},{default:w(()=>[...o[0]||(o[0]=[R("清除选择",-1)])]),_:1}),_(P,{style:{margin:"0 5px","line-height":"30px"},label:"默认选择整张图片",position:"is-right",type:"is-dark"},{default:w(()=>[_(x,{icon:"circle-exclamation"})]),_:1})]),s("div",{class:"image-area",ref_key:"imageAreaRef",ref:c,onMousedown:I,onMousemove:V,onMouseup:S,onMouseleave:S},[s("img",{ref_key:"imageRef",ref:d,src:n.imageUrl,alt:"Selectable Image",onLoad:p,draggable:"false"},null,40,_t),t.active?(g(),M("div",{key:0,class:"selection-box",style:G($.value)},null,4)):D("",!0)],544)])}}},xt=H(mt,[["__scopeId","data-v-11faaa9a"]]);export{xt as _,yt as a};
