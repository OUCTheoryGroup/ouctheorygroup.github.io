import{_ as J}from"./result_mask-DVoKs7o9.js";import{_ as F,p as P,e as o,r as v,g as M,c as L,o as y,a,i as f,m as q,y as j,n as $,t as _,j as I,F as z,l as E,u as Y,B as K,D as O}from"./index-D1ToNYlt.js";const Q={class:"resultDisplayContainer"},Z={class:"resultContainer"},tt={class:"title"},et={class:"resultList"},at={class:"taskId"},st={class:"idBox"},ot={class:"tag"},lt=["onClick"],nt={key:0,class:"iconBox"},it={key:1,class:"iconBox"},ut={class:"createdTime"},rt={class:"modalBox"},ct={class:"title"},dt={class:"content"},vt=["src","onClick"],ht={style:{"text-align":"center",margin:"2px 0"}},mt=["src"],pt={__name:"index",props:{title:{type:String,default:""},tooltip:{type:String,default:""},emptyMessage:{type:String,default:""},taskList:{type:Array,default:()=>[],required:!0},resultList:{type:Array,default:()=>[],required:!0},modalTitle:{type:String,default:""}},setup(d){const{t:h}=P(),m=d,R=o(()=>m.title||h("components.resultDisplay.title")),U=o(()=>m.tooltip||h("components.resultDisplay.tooltip")),w=o(()=>m.emptyMessage||h("common.message.noResult")),p=o(()=>m.modalTitle||h("components.resultDisplay.modalTitle")),B="https://assets-seaice-eo.52lxy.top",t=v(!1),l=v(null),u=v(null),c=v(!1),i=o(()=>l.value!==null&&m.resultList[l.value]?m.resultList[l.value].images||[]:[]),A=r=>{m.resultList[r]?.status==="完成"&&(t.value=!0,l.value=r)},N=r=>{u.value=r,c.value=!0},T=r=>r?r.startsWith("http")?r:B+r:"";return(r,x)=>{const C=M("vue-fontawesome"),S=M("b-tooltip"),X=M("b-message"),W=M("b-tag"),H=M("b-notification"),D=M("b-modal");return y(),L("div",Q,[a("div",Z,[a("section",null,[a("h3",tt,[$(_(R.value)+" ",1),f(S,{label:U.value,position:"is-bottom",type:"is-dark"},{default:I(()=>[f(C,{icon:"circle-exclamation"})]),_:1},8,["label"])]),d.taskList.length==0?(y(),q(X,{key:0},{default:I(()=>[$(_(w.value),1)]),_:1})):j("",!0)]),a("section",et,[(y(!0),L(z,null,E(d.taskList,(n,g)=>(y(),q(H,{closable:!1,key:n.task_id},{default:I(()=>[a("div",at,[a("span",st,_(Y(h)("components.resultDisplay.taskId"))+": "+_(n.task_id),1),a("span",ot,[f(W,{type:d.resultList[g]?.status==="完成"?"is-success is-light":"is-warning is-light"},{default:I(()=>[$(_(d.resultList[g]?.status==="完成"?Y(h)("common.status.completed"):d.resultList[g]?.status==="进行中"?Y(h)("common.status.processing"):d.resultList[g]?.status),1)]),_:2},1032,["type"])])]),a("div",{class:"resultMask",onClick:V=>A(g)},[x[2]||(x[2]=a("img",{src:J,alt:""},null,-1)),d.resultList[g]?.status==="完成"?(y(),L("span",nt,[f(C,{class:"eyeIcon",icon:"eye"})])):(y(),L("span",it,[f(C,{class:"eyeIcon",icon:"eye-slash"})]))],8,lt),a("div",ut,_(Y(h)("components.resultDisplay.submitTime"))+": "+_(n.created_time),1)]),_:2},1024))),128))])]),f(D,{modelValue:t.value,"onUpdate:modelValue":x[0]||(x[0]=n=>t.value=n)},{default:I(()=>[a("div",rt,[a("h3",ct,_(p.value),1),a("div",dt,[(y(!0),L(z,null,E(i.value,(n,g)=>(y(),L("li",{class:"imgItem",key:g},[a("img",{src:T(n?.path||n),alt:"Result Image",onClick:V=>N(n?.path||n)},null,8,vt),a("p",ht,_(n?.date),1)]))),128))])])]),_:1},8,["modelValue"]),f(D,{modelValue:c.value,"onUpdate:modelValue":x[1]||(x[1]=n=>c.value=n),class:"previewModal"},{default:I(()=>[a("div",null,[a("img",{src:T(u.value),alt:"Preview Image"},null,8,mt)])]),_:1},8,["modelValue"])])}}},wt=F(pt,[["__scopeId","data-v-bad0c63b"]]),gt={class:"image-selector-container"},_t={class:"info-area"},yt=["src"],ft={__name:"index",props:{imageUrl:{type:String,required:!0},width:{type:Number,default:432},height:{type:Number,default:432}},emits:["selection-string"],setup(d,{emit:h}){const{t:m}=P(),R=d,U=h,w=v(null),p=v(null),B=v(!1),t=K({active:!1,x:0,y:0,width:0,height:0,startX:0,startY:0}),l=v(0),u=v(0),c=v(0),i=v(0),A=()=>{if(w.value){const e=w.value.getBoundingClientRect();e.left,e.top}p.value&&(l.value=Math.round(p.value.clientHeight||p.value.naturalHeight||0),u.value=Math.round(p.value.clientWidth||p.value.naturalWidth||0),c.value=p.value.naturalWidth||0,i.value=p.value.naturalHeight||0)},N=e=>{if(e.preventDefault(),!w.value)return;B.value=!0,t.active=!0;const s=w.value.getBoundingClientRect();t.startX=Math.round(e.pageX-s.left-window.scrollX),t.startY=Math.round(e.pageY-s.top-window.scrollY),t.x=t.startX,t.y=t.startY,t.width=0,t.height=0},T=e=>{if(!B.value)return;const s=w.value.getBoundingClientRect(),b=e.pageX-s.left-window.scrollX,k=e.pageY-s.top-window.scrollY;b<t.startX?(t.x=Math.round(b),t.width=Math.round(t.startX-b)):(t.x=Math.round(t.startX),t.width=Math.round(b-t.startX)),k<t.startY?(t.y=Math.round(k),t.height=Math.round(t.startY-k)):(t.y=Math.round(t.startY),t.height=Math.round(k-t.startY))},r=()=>{B.value=!1,t.width===0&&t.height===0?x():V()},x=()=>{t.active=!1,t.width=u.value||c.value||0,t.height=l.value||i.value||0,t.x=0,t.y=0,V()},C=o(()=>({left:`${t.x}px`,top:`${t.y}px`,width:`${t.width}px`,height:`${t.height}px`}));o(()=>({x:Math.round(t.x+t.width),y:Math.round(t.y)})),o(()=>({x:Math.round(t.x),y:Math.round(t.y+t.height)})),o(()=>({x:Math.round(t.x+t.width),y:Math.round(t.y+t.height)}));const S=o(()=>c.value>0?R.width/c.value:1),X=o(()=>i.value>0?R.height/i.value:1),W=o(()=>{const e=u.value>0?t.x/u.value*c.value:t.x,s=l.value>0?t.y/l.value*i.value:t.y;return{x:Math.round(e*S.value),y:Math.round((i.value-s)*X.value)}}),H=o(()=>{const e=u.value>0?(t.x+t.width)/u.value*c.value:t.x+t.width,s=l.value>0?t.y/l.value*i.value:t.y;return{x:Math.round(e*S.value),y:Math.round((i.value-s)*X.value)}}),D=o(()=>{const e=u.value>0?t.x/u.value*c.value:t.x,s=l.value>0?(t.y+t.height)/l.value*i.value:t.y+t.height;return{x:Math.round(e*S.value),y:Math.round((i.value-s)*X.value)}}),n=o(()=>{const e=u.value>0?(t.x+t.width)/u.value*c.value:t.x+t.width,s=l.value>0?(t.y+t.height)/l.value*i.value:t.y+t.height;return{x:Math.round(e*S.value),y:Math.round((i.value-s)*X.value)}}),g=o(()=>{const e=D.value,s=W.value,b=n.value,k=H.value;return{bl:e,tl:s,br:b,tr:k}});function V(){U("selection-string",g.value)}return(e,s)=>{const b=M("b-button"),k=M("vue-fontawesome"),G=M("b-tooltip");return y(),L("div",gt,[a("div",_t,[f(b,{onClick:x,size:"is-small"},{default:I(()=>[$(_(Y(m)("common.button.clearSelection")),1)]),_:1}),f(G,{style:{margin:"0 5px","line-height":"30px"},label:Y(m)("components.imageSelector.defaultSelection"),position:"is-right",type:"is-dark"},{default:I(()=>[f(k,{icon:"circle-exclamation"})]),_:1},8,["label"])]),a("div",{class:"image-area",ref_key:"imageAreaRef",ref:w,onMousedown:N,onMousemove:T,onMouseup:r,onMouseleave:r},[a("img",{ref_key:"imageRef",ref:p,src:d.imageUrl,alt:"Selectable Image",onLoad:A,draggable:"false"},null,40,yt),t.active?(y(),L("div",{key:0,class:"selection-box",style:O(C.value)},null,4)):j("",!0)],544)])}}},bt=F(ft,[["__scopeId","data-v-1ab209cf"]]);export{bt as _,wt as a};
